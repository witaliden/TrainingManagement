@model LoginViewModel

<h2>Logowanie do aplikacji</h2>

<div class="row">
    <div class="col-md-6">
        <form id="loginForm" asp-action="Login" method="post">
            <div asp-validation-summary="ModelOnly" class="text-danger"></div>

            <div class="form-group mb-3">
                <label>Login</label>
                <input type="text" id="username" name="username" class="form-control" required />
            </div>

            <div id="otpSection" style="display: none;">
                <div class="alert alert-info">
                    Wartość x: <span id="xValue"></span>
                    <br />
                    Oblicz: y = a*ln(x), gdzie a jest długością twojego loginu
                </div>

                <div class="form-group mb-3">
                    <label>Obliczona wartość y</label>
                    <input type="text" id="calculatedY" name="calculatedY" class="form-control" required />
                </div>
            </div>

            <button type="button" id="validateUsername" class="btn btn-primary">Dalej</button>
            <button type="submit" id="submitLogin" class="btn btn-success" style="display: none;">Zaloguj</button>
        </form>
    </div>
</div>

@section Scripts {
    <script>
        $(document).ready(function() {
            $("#validateUsername").click(function() {
                var username = $("#username").val();
                $.post("/Account/ValidateUsername", { username: username }, function(response) {
                    if (response.success) {
                        $("#otpSection").show();
                        $("#xValue").text(response.x);
                        $("#validateUsername").hide();
                        $("#submitLogin").show();
                    } else {
                        alert(response.message);
                    }
                });
            });
        });
    </script>
}
